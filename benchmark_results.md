# Benchmark Results

In the AMD64 environment, we get a benchmark results.

- OS/Arch: linux/amd64
- CPU: AMD Ryzen 9 6900HX with Radeon Graphics

## Comparison (Native Arrow functions)
**100M Records**
- Comparison uses Apache Arrow kernel fully to generate the filter
- Gleam x30 - 390 faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
|:---|:---|---:|---:|---:|---:|
| **Int8** | **gleam** | **18,749,930** | **5,333.35** | **12,503,595** | **45** |
| | gota | 7,308,522,498 | 13.68 | 4,300,023,200 | 200,000,020 |
| **Int16** | **gleam** | **28,140,844** | **7,107.11** | **12,503,509** | **46** |
| | gota | 7,388,856,540 | 27.07 | 4,300,022,968 | 200,000,018 |
| **Int32** | **gleam** | **30,280,191** | **13,209.96** | **12,503,459** | **47** |
| | gota | 7,317,099,875 | 54.67 | 4,300,022,968 | 200,000,018 |
| **Int64** | **gleam** | **44,702,130** | **17,896.24** | **12,503,488** | **48** |
| | gota | 7,223,601,843 | 110.75 | 4,300,022,984 | 200,000,019 |
| **Uint8** | **gleam** | **18,415,166** | **5,430.31** | **12,503,577** | **41** |
| | gota | 7,234,248,841 | 13.82 | 4,300,023,200 | 200,000,020 |
| **Uint16** | **gleam** | **28,598,659** | **6,993.33** | **12,503,506** | **42** |
| | gota | 7,379,233,654 | 27.10 | 4,300,022,968 | 200,000,018 |
| **Uint32** | **gleam** | **31,088,579** | **12,866.46** | **12,503,463** | **43** |
| | gota | 7,234,382,380 | 55.29 | 4,300,023,376 | 200,000,022 |
| **Uint64** | **gleam** | **43,629,712** | **18,336.13** | **12,503,509** | **44** |
| | gota | 7,224,689,748 | 110.73 | 4,300,022,968 | 200,000,018 |
| **Float32** | **gleam** | **36,310,004** | **11,016.25** | **12,503,470** | **49** |
| | gota | 1,178,941,709 | 339.29 | 300,015,704 | 6 |
| **Float64** | **gleam** | **44,370,369** | **18,030.05** | **12,503,490** | **50** |
| | gota | 1,265,802,964 | 632.01 | 300,015,704 | 6 |

**1M Records**
 - Gleam 30-300 times faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
| :--- | :--- | ---:| ---:| ---:| ---:|
| **Int8** | **gleam** | **240,457** | **4,158.76** | **133,627** | **45** |
| | gota | 70,563,105 | 14.17 | 43,020,816 | 2,000,016 |
| **Int16** | **gleam** | **327,581** | **6,105.37** | **133,571** | **46** |
| | gota | 70,622,632 | 28.32 | 43,020,862 | 2,000,017 |
| **Int32** | **gleam** | **319,229** | **12,530.20** | **133,532** | **47** |
| | gota | 76,932,964 | 51.99 | 43,020,888 | 2,000,018 |
| **Int64** | **gleam** | **320,670** | **24,947.74** | **133,507** | **48** |
| | gota | 71,686,338 | 111.60 | 43,020,877 | 2,000,018 |
| **Uint8** | **gleam** | **231,006** | **4,328.89** | **133,608** | **41** |
| | gota | 70,958,215 | 14.09 | 43,020,859 | 2,000,017 |
| **Uint16** | **gleam** | **336,975** | **5,935.16** | **133,559** | **42** |
| | gota | 70,765,361 | 28.26 | 43,020,774 | 2,000,017 |
| **Uint32** | **gleam** | **326,193** | **12,262.68** | **133,523** | **43** |
| | gota | 72,105,037 | 55.47 | 43,020,742 | 2,000,017 |
| **Uint64** | **gleam** | **314,036** | **25,474.76** | **133,506** | **44** |
| | gota | 71,666,378 | 111.63 | 43,020,745 | 2,000,017 |
| **Float32** | **gleam** | **375,087** | **10,664.20** | **133,531** | **49** |
| | gota | 11,903,195 | 336.04 | 3,014,751 | 6 |
| **Float64** | **gleam** | **383,611** | **20,854.48** | **133,507** | **50** |
| | gota | 12,067,676 | 662.93 | 3,014,751 | 6 |

**10,000 Records**
 - Gleam 25-100 times faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
| :--- | :--- | ---:| ---:| ---:| ---:|
| **Int8** | **gleam** | **8,281** | **1,207.64** | **3,811** | **45** |
| | gota | 857,256 | 11.67 | 431,148 | 20,006 |
| **Int16** | **gleam** | **9,191** | **2,175.93** | **3,811** | **46** |
| | gota | 836,418 | 23.91 | 431,149 | 20,006 |
| **Int32** | **gleam** | **9,377** | **4,265.95** | **3,811** | **47** |
| | gota | 839,832 | 47.63 | 431,152 | 20,006 |
| **Int64** | **gleam** | **9,794** | **8,168.04** | **3,811** | **48** |
| | gota | 908,362 | 88.07 | 431,152 | 20,006 |
| **Uint8** | **gleam** | **8,065** | **1,239.91** | **3,803** | **41** |
| | gota | 852,383 | 11.73 | 431,155 | 20,006 |
| **Uint16** | **gleam** | **9,112** | **2,194.95** | **3,803** | **42** |
| | gota | 833,759 | 23.99 | 431,154 | 20,006 |
| **Uint32** | **gleam** | **9,245** | **4,326.66** | **3,803** | **43** |
| | gota | 861,641 | 46.42 | 431,161 | 20,006 |
| **Uint64** | **gleam** | **9,395** | **8,515.01** | **3,811** | **44** |
| | gota | 845,042 | 94.67 | 431,159 | 20,006 |
| **Float32** | **gleam** | **10,074** | **3,970.51** | **3,811** | **49** |
| | gota | 132,683 | 301.47 | 30,808 | 6 |
| **Float64** | **gleam** | **10,365** | **7,718.01** | **3,811** | **50** |
| | gota | 137,187 | 583.15 | 30,808 | 6 |



## Sum (Hybrid implementation Arrow Kernel and Go native)

 - Switch compute method threshold: 150 thousand records
   - Lower: Go native loop
   - Higher: Type cast to 64-bit and Arrow Sum function

**100M Records**
- Sum with Type cast and arrow sum
- Exist type cast however, faster 3–5 times faster than Gota
- For 64-bit numeric, x30 faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
|:---|:---|---:|---:|-----------------:|----------------:|
| **Int8** | **gleam** | **143,100,841** | **698.81** |      800,010,294 |              51 |
| | gota | 576,153,860 | 173.56 |      800,006,168 |               2 |
| **Int16** | **gleam** | **150,639,193** | **1,327.68** |      800,010,217 |              52 |
| | gota | 572,930,602 | 349.08 |      800,006,168 |               2 |
| **Int32** | **gleam** | **177,526,915** | **2,253.18** |      800,010,420 |              54 |
| | gota | 505,827,046 | 790.78 |      800,006,312 |               3 |
| **Int64** | **gleam** | **22,690,643** | **35,256.82** |          **481** |               7 |
| | gota | 622,909,027 | 1,284.30 |      800,006,216 |               2 |
| **Uint8** | **gleam** | **147,388,549** | **678.48** |      800,010,209 |              47 |
| | gota | 610,796,110 | 163.72 |      800,006,264 |               3 |
| **Uint16** | **gleam** | **153,834,369** | **1,300.10** |      800,010,199 |              48 |
| | gota | 572,948,912 | 349.07 |      800,006,168 |               2 |
| **Uint32** | **gleam** | **181,492,473** | **2,203.95** |      800,010,221 |              49 |
| | gota | 519,858,944 | 769.44 |      800,006,168 |               2 |
| **Uint64** | **gleam** | **23,291,208** | **34,347.72** |          **480** |               7 |
| | gota | 614,431,765 | 1,302.02 |      800,006,168 |               2 |
| **Float32** | **gleam** | **160,202,697** | **2,496.84** |      800,010,205 |              55 |
| | gota | 571,783,380 | 699.57 |      800,006,168 |               2 |
| **Float64** | **gleam** | **22,841,290** | **35,024.29** |          **480** |               7 |
| | gota | 623,423,669 | 1,283.24 |      800,006,144 |               1 |

**1M Records**

 - Faster 3–5 times faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
|:---|:---|---:|---:|---:|---:|
| **Int8** | **gleam** | **1,046,962** | **955.14** | **8,007,361** | **51** |
| | gota | 5,070,408 | 197.22 | 8,003,602 | 1 |
| **Int16** | **gleam** | **1,146,852** | **1,743.90** | **8,007,343** | **52** |
| | gota | 5,129,076 | 389.93 | 8,003,602 | 1 |
| **Int32** | **gleam** | **1,164,516** | **3,434.90** | **8,007,348** | **53** |
| | gota | 5,109,682 | 782.83 | 8,003,602 | 1 |
| **Int64** | **gleam** | **68,174** | **117,346.16** | **480** | **7** |
| | gota | 5,032,616 | 1,589.63 | 8,003,600 | 1 |
| **Uint8** | **gleam** | **1,078,259** | **927.42** | **8,007,337** | **47** |
| | gota | 5,078,095 | 196.92 | 8,003,602 | 1 |
| **Uint16** | **gleam** | **1,124,290** | **1,778.90** | **8,007,336** | **48** |
| | gota | 5,070,499 | 394.44 | 8,003,602 | 1 |
| **Uint32** | **gleam** | **1,275,191** | **3,136.78** | **8,007,339** | **49** |
| | gota | 5,104,524 | 783.62 | 8,003,601 | 1 |
| **Uint64** | **gleam** | **68,299** | **117,132.00** | **480** | **7** |
| | gota | 5,136,406 | 1,557.51 | 8,003,601 | 1 |
| **Float32** | **gleam** | **1,269,173** | **3,151.66** | **8,007,346** | **55** |
| | gota | 5,082,707 | 786.98 | 8,003,601 | 1 |
| **Float64** | **gleam** | **68,281** | **117,163.73** | **480** | **7** |
| | gota | 5,198,621 | 1,538.87 | 8,003,601 | 1 |

**10,000 Records**
- Sum function uses Go native loop when the Series is small except for 64-bit numeric.
- Gleam Faster 10-50 times faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
|:---|:---|---:|---:|---:|---:|
| **Int8** | **gleam** | **4,658** | **2,147.03** | **480** | **7** |
| | gota | 66,253 | 150.94 | 81,922 | 1 |
| **Int16** | **gleam** | **5,073** | **3,942.41** | **480** | **7** |
| | gota | 65,784 | 304.03 | 81,922 | 1 |
| **Int32** | **gleam** | **4,991** | **8,013.97** | **480** | **7** |
| | gota | 64,996 | 615.43 | 81,922 | 1 |
| **Int64** | **gleam** | **969.4** | **82,524.34** | **480** | **7** |
| | gota | 64,939 | 1,231.93 | 81,921 | 1 |
| **Uint8** | **gleam** | **4,696** | **2,129.45** | **480** | **7** |
| | gota | 65,708 | 152.19 | 81,922 | 1 |
| **Uint16** | **gleam** | **4,787** | **4,178.06** | **480** | **7** |
| | gota | 65,475 | 305.46 | 81,922 | 1 |
| **Uint32** | **gleam** | **4,751** | **8,419.22** | **480** | **7** |
| | gota | 65,141 | 614.05 | 81,922 | 1 |
| **Uint64** | **gleam** | **1,008** | **79,348.93** | **480** | **7** |
| | gota | 65,324 | 1,224.66 | 81,922 | 1 |
| **Float32** | **gleam** | **6,629** | **6,034.16** | **480** | **7** |
| | gota | 65,437 | 611.27 | 81,922 | 1 |
| **Float64** | **gleam** | **1,007** | **79,477.32** | **480** | **7** |
| | gota | 66,373 | 1,205.31 | 81,922 | 1 |


## Max (Native Go loop implementation)

 - Unfortunately, arrow-go doesn't have a "max"/"min" function now.
 - Implement Go native loop with arrow Array

**100M Records**
 - Gleam 3-30 times faster than Gota

| データ型      | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇  | アロケーション回数/Op 👇  |
| :---------- | :--------- | --------------------: | ---------------------: | --------------------: | -------------------------: |
| **Int8** | **gleam** |         **215,856,071** |               **463.27** |                   **656** |                        **8** |
|             | gota       |       6,648,350,197 |                  15.04 |         4,000,007,224 |                200,000,010 |
| **Int16** | **gleam** |         **244,067,208** |               **819.45** |                   **656** |                        **8** |
|             | gota       |       6,843,417,427 |                  29.23 |         4,000,007,224 |                200,000,010 |
| **Int32** | **gleam** |         **228,221,501** |             **1,752.68** |                   **720** |                        **8** |
|             | gota       |       6,801,276,869 |                  58.81 |         4,000,007,320 |                200,000,011 |
| **Int64** | **gleam** |         **244,945,082** |             **3,266.04** |                   **848** |                        **8** |
|             | gota       |       6,833,117,267 |                 117.08 |         4,000,012,992 |                200,000,020 |
| **Uint8** | **gleam** |         **229,117,478** |               **436.46** |                   **656** |                        **8** |
|             | gota       |       6,763,319,578 |                  14.79 |         4,000,007,456 |                200,000,012 |
| **Uint16** | **gleam** |         **244,985,999** |               **816.37** |                   **656** |                        **8** |
|             | gota       |       6,787,809,873 |                  29.46 |         4,000,007,224 |                200,000,010 |
| **Uint32** | **gleam** |         **229,326,942** |             **1,744.23** |                   **720** |                        **8** |
|             | gota       |       6,861,238,080 |                  58.30 |         4,000,007,224 |                200,000,010 |
| **Uint64** | **gleam** |         **245,142,407** |             **3,263.41** |                   **848** |                        **8** |
|             | gota       |       6,655,925,267 |                 120.19 |         4,000,007,552 |                200,000,013 |
| **Float32** | **gleam** |         **229,720,279** |             **1,741.25** |                   **720** |                        **8** |
|             | gota       |         585,281,766 |                 683.43 |                       0 |                          0 |
| **Float64** | **gleam** |         **244,961,698** |             **3,265.82** |                   **848** |                        **8** |
|             | gota       |         617,850,250 |               1,294.81 |                       0 |                          0 |

**1M Records**
 - Gleam faster 3-25 times faster than Gota 

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
| :--- | :--- | ---:| ---:| ---:| ---:|
| **Int8** | **gleam** | **2,164,740** | **461.95** | **656** | **8** |
| | gota | 65,372,188 | 15.30 | 40,006,019 | 2,000,009 |
| **Int16** | **gleam** | **2,486,872** | **804.22** | **656** | **8** |
| | gota | 65,172,378 | 30.69 | 40,006,022 | 2,000,009 |
| **Int32** | **gleam** | **2,288,393** | **1,747.95** | **720** | **8** |
| | gota | 64,906,447 | 61.63 | 40,006,037 | 2,000,009 |
| **Int64** | **gleam** | **2,488,501** | **3,214.79** | **848** | **8** |
| | gota | 65,837,415 | 121.51 | 40,006,046 | 2,000,009 |
| **Uint8** | **gleam** | **2,294,479** | **435.83** | **656** | **8** |
| | gota | 65,319,007 | 15.31 | 40,006,045 | 2,000,009 |
| **Uint16** | **gleam** | **2,491,007** | **802.89** | **656** | **8** |
| | gota | 65,383,392 | 30.59 | 40,006,023 | 2,000,009 |
| **Uint32** | **gleam** | **2,292,131** | **1,745.10** | **720** | **8** |
| | gota | 65,381,520 | 61.18 | 40,005,932 | 2,000,008 |
| **Uint64** | **gleam** | **2,491,687** | **3,210.68** | **848** | **8** |
| | gota | 65,494,105 | 122.15 | 40,006,110 | 2,000,010 |
| **Float32** | **gleam** | **2,296,026** | **1,742.14** | **720** | **8** |
| | gota | 6,539,868 | 611.63 | 0 | 0 |
| **Float64** | **gleam** | **2,495,818** | **3,205.36** | **848** | **8** |
| | gota | 6,336,340 | 1,262.56 | 0 | 0 |

**10,000 Records**
 - Gleam 3-30 times faster than Gota

| データ型 | ライブラリ | 処理時間 (ns/op) 👇 | スループット (MB/s) 👆 | メモリ/Op (B/op) 👇 | アロケーション回数/Op 👇 |
| :--- | :--- | ---:| ---:| ---:| ---:|
| **Int8** | **gleam** | **22,257** | **449.31** | **656** | **8** |
| | gota | 782,003 | 12.79 | 400,269 | 19,998 |
| **Int16** | **gleam** | **25,786** | **775.61** | **656** | **8** |
| | gota | 784,142 | 25.51 | 400,267 | 19,998 |
| **Int32** | **gleam** | **23,465** | **1,704.66** | **720** | **8** |
| | gota | 781,047 | 51.21 | 400,268 | 19,998 |
| **Int64** | **gleam** | **25,607** | **3,124.11** | **848** | **8** |
| | gota | 777,851 | 102.85 | 400,264 | 19,998 |
| **Uint8** | **gleam** | **23,484** | **425.82** | **656** | **8** |
| | gota | 771,119 | 12.97 | 400,264 | 19,998 |
| **Uint16** | **gleam** | **25,515** | **783.85** | **656** | **8** |
| | gota | 772,883 | 25.88 | 400,267 | 19,998 |
| **Uint32** | **gleam** | **23,678** | **1,689.33** | **720** | **8** |
| | gota | 778,070 | 51.41 | 400,267 | 19,998 |
| **Uint64** | **gleam** | **25,620** | **3,122.58** | **848** | **8** |
| | gota | 770,661 | 103.81 | 400,270 | 19,998 |
| **Float32** | **gleam** | **23,631** | **1,692.67** | **720** | **8** |
| | gota | 60,362 | 662.67 | 0 | 0 |
| **Float64** | **gleam** | **25,585** | **3,126.79** | **848** | **8** |
| | gota | 62,533 | 1,279.32 | 0 | 0 |